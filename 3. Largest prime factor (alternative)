# Problem 3

start_time <- Sys.time()

number <- 600851475143

prime_factors <- function(number){
  factors <- vector()
  while(number %% 2 == 0){ # we treat 2 as a separate case because it is the only even prime factor
    number <- number/2
    factors <- c(factors,2)
  }
  while(number %% 3 == 0){ # treat 3 as a separate case since it is the only prime not of the form 6*i +- 1
    number <- number/3
    factors <- c(factors,3)
  }
  i <- 1
  while(number > 1){
    candidates <- c(6*i-1,6*i+1) # all primes greater than 3 can be written in that form
    for (j in c(1,2)){
      if(sum(candidates[j] %% factors[factors <= sqrt(candidates[j])] == 0) == 0){ # a composite number has prime factors <= sqrt(nu)
        while(number %% candidates[j] == 0){
          number <- number/candidates[j]
          factors <- c(factors,candidates[j])
        }
      }
    }
    i <- i + 1
  }
  return(factors)
}

prime_fact <- prime_factors(number)

end_time <- Sys.time()
end_time - start_time  
